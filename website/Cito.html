<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta lang="en" />
    <title>Citco Report</title>
    <meta
      name="description"
      content="Research document about publication and citation count's influence on obtaining the NSERC Discovery Grant award."
    />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="cito.css" />
    <link
      rel="stylesheet"
      href="https://cdn.datatables.net/1.13.6/css/jquery.dataTables.min.css"
    />
  </head>
  <body class="parent">
    <header class="div1">
      <h1>Title Report</h1>
    </header>

    <article class="div2 content-wrapper">
      <h2>Introduction</h2>
      <p>
        This report investigates the potential correlation between research
        productivity and grant allocation by analyzing citation and publication
        data in relation to the NSERC Discovery Grant (DG). The Discovery Grant,
        offered by the Natural Sciences and Engineering Research Council of
        Canada, supports Canadian university researchers in advancing knowledge
        across science and engineering disciplines. One of the key indicators
        often used—albeit unofficially—to assess a researcher's impact is the
        volume of their recent scholarly output and its reception in the
        academic community. To explore this relationship, we collected data on
        Canadian computer scientists who received a DG over the past 15 years,
        then compiled their publication and citation counts from Google Scholar,
        focusing on the six years preceding their grant year. This study aims to
        determine whether a measurable link exists between research impact and
        funding decisions through statistical analysis and data visualization.
      </p>

      <div style="margin-bottom: 1rem">
        <label for="yearStart">Start Year:</label>
        <select id="yearStart" onchange="filterByYearRange()"></select>

        <label for="yearEnd">End Year:</label>
        <select id="yearEnd" onchange="filterByYearRange()"></select>

        <button onclick="downloadPDF()">Download PDF</button>
        <button onclick="downloadCSV()">Download CSV</button>
      </div>

      <h3>Researcher Output</h3>
      <table id="researcherTable" class="display">
        <thead>
          <tr>
            <th>Name</th>
            <th>Year</th>
            <th>Publication Count</th>
            <th>Citation Count</th>
          </tr>
        </thead>
        <tbody id="table-body"></tbody>
      </table>
    </article>

    <article class="div3 content-wrapper">
      <h2>Results</h2>
      <p>
        The analysis conducted in this project reveals a moderate positive
        correlation between researchers’ publication and citation counts and
        their eligibility for the NSERC Discovery Grant, as reflected by a
        Pearson correlation coefficient of 0.59. While this suggests that higher
        research output and academic influence may enhance a researcher’s
        chances of receiving funding, it also highlights that citations and
        publications are only part of a broader evaluation process. Other
        qualitative factors likely play a role in funding decisions, such as the
        research proposal’s innovation, relevance, and alignment with NSERC’s
        priorities. Nonetheless, this study demonstrates how publicly available
        data and simple statistical tools can provide meaningful insights into
        the dynamics of research funding in Canada’s academic landscape.
      </p>
    </article>

    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>

    <script>
      const yearRange = Array.from(
        { length: 2023 - 2008 + 1 },
        (_, i) => 2008 + i
      );

      function populateYearDropdowns() {
        const startSelect = document.getElementById("yearStart");
        const endSelect = document.getElementById("yearEnd");

        yearRange.forEach((year) => {
          startSelect.innerHTML += `<option value="${year}">${year}</option>`;
          endSelect.innerHTML += `<option value="${year}">${year}</option>`;
        });

        startSelect.value = "2008";
        endSelect.value = "2023";
      }

      function filterByYearRange() {
        const start = parseInt(document.getElementById("yearStart").value);
        const end = parseInt(document.getElementById("yearEnd").value);

        // Remove all old filters first
        $.fn.dataTable.ext.search = $.fn.dataTable.ext.search.filter(
          (f) => false
        );

        $.fn.dataTable.ext.search.push(function (settings, data, dataIndex) {
          const year = parseInt(data[1]); // Year is column 1
          return year >= start && year <= end;
        });

        $("#researcherTable").DataTable().draw();
      }

      function downloadCSV() {
        const table = $("#researcherTable").DataTable();
        const data = table.rows({ filter: "applied" }).data();

        const rows = [["Name", "Year", "Publication Count", "Citation Count"]];
        for (let i = 0; i < data.length; i++) {
          rows.push(data[i]);
        }

        const csvContent = rows
          .map((e) => e.map((cell) => `"${cell}"`).join(","))
          .join("\n");
        const blob = new Blob([csvContent], {
          type: "text/csv;charset=utf-8;",
        });
        const url = URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.setAttribute("href", url);
        a.setAttribute("download", "filtered_researcher_data.csv");
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
      }

      function downloadPDF() {
        window.print();
      }

      fetch("output.txt")
        .then((response) => response.text())
        .then((text) => {
          const lines = text.split(/[\r\n]+/);

          const tbody = document.getElementById("table-body");

          lines.forEach((line) => {
            const regex =
              /Name:\s*(.*?)\s+Year:\s*(\d{4})\s+Publication count:\s*(\d+)\s+Citation count:\s*(\d+)/;

            const match = line.match(regex);
            if (match) {
              const [_, name, year, pubs, cits] = match;
              const row = `<tr><td>${name}</td><td>${year}</td><td>${pubs}</td><td>${cits}</td></tr>`;
              tbody.insertAdjacentHTML("beforeend", row);
            }
          });

          populateYearDropdowns();
          $("#researcherTable").DataTable({ pageLength: 10 });
        })
        .catch((error) => {
          console.error("Could not load output.txt:", error);
        });
    </script>
  </body>
</html>
